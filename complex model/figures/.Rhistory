par(mfrow=c(2,5),oma = c(3,0,0,0) + 0.1, mar = c(4,4,1,1) + 0.1)
#layout(matrix(c(1,1,2,2, 3,4,5, 6), 2, 4, byrow = TRUE))
mypalette <- c("#808080","#CCCCCC","#D55E00")
names(mypalette) <- c("a", "b", "Stay in port")
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,81), xlab = "Year", ylab = "Effort pattern (%)", xaxt = "n",space = 0)
axis(1, at = c(0.5, 20.5, 30.5, 40.5, 60.5, 80.5),labels = c(10, 30,"MP",50,70,90))
legend("topright", inset=.05, legend=c("a", "b", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
boxplot(value ~ year, netrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean net revenue",
ylim=c(0,4000), xlim=c(1, 81), xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, netrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean net revenue",
ylim=c(0,4000), xlim=c(1, 81), xaxt = "n", add=TRUE)
boxplot(value ~ year, grossrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean gross revenue",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, grossrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean gross revenue",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n", add=TRUE)
boxplot(value ~ year, fuelcosts, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean fuel costs",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, fuelcosts, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean fuel costs",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n", add=TRUE)
boxplot(value ~ year, annualfine, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean annual fine",
ylim=c(0,4000), xlim=c(1,81),  xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, annualfine, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean annual fine",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n", add=TRUE)
barplot(as.matrix(days), col=c("#808080","#CCCCCC"),border=NA, xlim = c(1,81), xlab = "Year", ylab = "Total days at sea", xaxt = "n",space = 0)
axis(1, at = c(0.5, 20.5, 30.5, 40.5, 60.5, 80.5),labels = c(10, 30,"MP",50,70,90))
abline(v=MPstart-9.5, lty=2)
plot(aggregate(value ~ year, FUN=sum, data=netrev)$year,aggregate(value ~ year, FUN=sum, data=netrev)$value, type="l", ylim=c(0,2091351), xlim=c(10,90), xlab = "Year", ylab = "Total net revenue", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=netrev)$year,aggregate(value ~ year, FUN=sum, data=netrev)$value, type="l")
plot(aggregate(value ~ year, FUN=sum, data=grossrev)$year, aggregate(value ~ year, FUN=sum, data=grossrev)$value, type="l", ylim=c(0,2091351), xlim=c(10,90), xlab = "Year", ylab = "Total gross revenue", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=grossrev)$year, aggregate(value ~ year, FUN=sum, data=grossrev)$value, type="l")
plot(aggregate(value ~ year, FUN=sum, data=fuelcosts)$year, aggregate(value ~ year, FUN=sum, data=fuelcosts)$value, type="l", ylim=c(0,2091351), xlim=c(10,90), xlab = "Year", ylab = "Total fuel costs", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=fuelcosts)$year, aggregate(value ~ year, FUN=sum, data=fuelcosts)$value, type="l")
plot(aggregate(value ~ year, FUN=sum, data=annualfine)$year, aggregate(value ~ year, FUN=sum, data=annualfine)$value, type="l", ylim=c(0,209130), xlim=c(10,90),xlab = "Year", ylab = "Total annual fine", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=annualfine)$year, aggregate(value ~ year, FUN=sum, data=annualfine)$value, type="l")
add_legend("bottomright", legend=paste0("SIGMA ", SIGMA, "; SIMNUMBER ",SIMNUMBER, "; DISCARDSTEPS ",SPP1DSCSTEPS, "; MIGRATION ",migconstant, "; REC1 ",paste(recs1, collapse = " "), "; REC2 ",paste(recs2, collapse = " "),"; FUELPRICE ",control@fuelPrice), col="black", horiz=TRUE, bty='n', cex=1)
dev.off()
#  }
#}
dev.off()
ylim <- c(0,1000)
xlimYPR <- c(0,0.2)
setwd("~/Dropbox/BoB/MSE/Git/Nekane/complex model/figures")
png(filename=paste("CATCH_", paste0("SIGMA ", SIGMA, "; SIMNUMBER ",SIMNUMBER, "; DISCARDSTEPS ",SPP1DSCSTEPS, "; MIGRATION ",migconstant, "; REC1 ",paste(recs1, collapse = " "), "; REC2 ",paste(recs2, collapse = " "), "; FUELPRICE ",control@fuelPrice,".png"), sep=""),width=20, height=8, units="cm", res=500, pointsize=6.5)
#to check
par(mfrow=c(2,5),oma = c(3,0,0,0) + 0.1, mar = c(4,4,1,1) + 0.1)
#,oma = c(4,3,1,1) + 0.1, mar = c(4,4,1,1) + 0.1)
plot(catches.wt.dsvm.tot1, type="l",  xlim=c(10,90), ylim=ylim, xaxs='i', yaxs='i', xlab= "Year", ylab = "Total catches (weight)", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines((quota1* SIMNUMBER), col="red" )
lines(catches.wt.dsvm.tot1,  type="l", ylim=ylim)
lines(landings.wt.dsvm.tot1, type="l", ylim=ylim, lty= 2)
legend("bottomright", inset=.05, legend=c("Catches","TAC"), pch=c(1,1), col=c("black","red"), bty='n', cex=0.8)
plot(apply(hr1,c(1,2),mean)[1,], type="p",  xlim=c(10,90), ylim=c(0,0.2), xaxs='i', yaxs='i', xlab= "Year", ylab = "Harvest rates", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
points(apply(hr1,c(1,2),mean)[1,], col="black", pch=19)
points(apply(hr1,c(1,2),mean)[2,], col="red", pch=19)
points(apply(hr1,c(1,2),mean)[3,], col="black", pch=21)
points(apply(hr1,c(1,2),mean)[4,], col="red", pch=21)
legend("topright", inset=.05, legend=c("Age 1","Age 2","Age 3","Age 4"), pch=c(19,19,21,21), col=c("black","red", "black","red"), bty='n', cex=0.8)
plot(x=yc1noMP$hr, y=yc1noMP$landings, type="l", xlim=xlimYPR, ylim=ylim,xaxs='i', yaxs='i',  xlab="Harvest rate", ylab = "Yield per recruit", panel.first=grid(col = "ivory2"))
text(xlimYPR[2]*0.8, yc1noMP$landings[length(yc1noMP$hr)]+5, "Unconstrained")
abline(v=Fmsy1noMP)
#text(xlimYPR[2]*0.8, ylim[2]*0.9, paste0("SIMNUMBER ",SIMNUMBER))
points(mean(hr1[,pyrnoMP,]),yc1noMP$landings[yc1noMP$hr>mean(hr1[,pyrnoMP,])][1], col="red", pch=19)
points(mean(hr1[,pyrnoMP-2,]),landings.wt.dsvm.tot1[,pyrnoMP-2,,], col="blue", pch=19)
points(mean(hr1[,pyrnoMP-1,]),landings.wt.dsvm.tot1[,pyrnoMP-1,,], col="blue", pch=19)
points(mean(hr1[,pyrnoMP,]),landings.wt.dsvm.tot1[,pyrnoMP,,], col="blue", pch=19)
points(mean(hr1[,pyrnoMP+1,]),landings.wt.dsvm.tot1[,pyrnoMP+1,,], col="blue", pch=19)
points(mean(hr1[,pyrnoMP+2,]),landings.wt.dsvm.tot1[,pyrnoMP+2,,], col="blue", pch=19)
lines(x=yc1MP$hr, y=yc1MP$landings, ylim=ylim, col="grey")
text(yc1MP$hr[length(yc1MP$hr)]-0.02, yc1MP$landings[length(yc1MP$hr)]+80, "Constrained")
abline(v=Fmsy1MP, col="grey")
points(mean(hr1[,pyrMP,]),yc1MP$landings[yc1MP$hr>mean(hr1[,pyrMP,])][1], col="red", pch=21, bg="white")
points(mean(hr1[,pyrMP-2,]),landings.wt.dsvm.tot1[,pyrMP-2,,], col="blue", pch=21, bg="white")
points(mean(hr1[,pyrMP-1,]),landings.wt.dsvm.tot1[,pyrMP-1,,], col="blue", pch=21, bg="white")
points(mean(hr1[,pyrMP,]),landings.wt.dsvm.tot1[,pyrMP,,], col="blue", pch=21, bg="white")
points(mean(hr1[,pyrMP+1,]),landings.wt.dsvm.tot1[,pyrMP+1,,], col="blue", pch=21, bg="white")
points(mean(hr1[,pyrMP+2,]),landings.wt.dsvm.tot1[,pyrMP+2,,], col="blue", pch=21, bg="white")
plot(rowMeans(hr1[,pyrnoMP,]), type="b", ylim=c(0,.2),  xlab="Age", ylab = "Selectivity", panel.first=grid(col = "ivory2"), xaxt="n")
text(1.5,rowMeans(hr1[,pyrnoMP,])[1]+0.01, "Unconstrained")
lines(rowMeans(hr1[,pyrMP,]), type="b", ylim=c(0,.2), col="grey")
text(1.5,rowMeans(hr1[,pyrMP,])[1]-0.01, "Constrained")
axis(1, at = seq(1, 4, by = 1))
plot(apply(catches.wt.dsvm1,c(2,4),sum)[,1], col="blue", type="l",  ylim=ylim,xaxs='i', yaxs='i', xlim=c(10,90),xlab = "Year", ylab = "Catches by area (weight)",xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(apply(catches.wt.dsvm1,c(2,4),sum)[,1], col="blue", type="l")
lines(apply(catches.wt.dsvm1,c(2,4),sum)[,2], col="red")
lines(apply(landings.wt.dsvm1,c(2,4),sum)[,1], col="blue", lty=2)
lines(apply(landings.wt.dsvm1,c(2,4),sum)[,2], col="red", lty=2)
#lines(apply(catches.wt.dsvm1,c(2,4),sum)[,3], col="black")
legend("topright", inset=.05, c("a","b"),  pch=c(1,1), col=c("blue","red"), bty='n', cex=0.8)
abline(v=MPstart, lty=2)
#round(pop1,0)
plot(catches.wt.dsvm.tot2, type="l",  xlim=c(10,90), ylim=ylim, xaxs='i', yaxs='i', xlab= "Year", ylab = "Total catches (weight)", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(catches.wt.dsvm.tot2,  type="l", ylim=ylim)
lines(landings.wt.dsvm.tot2, type="l", ylim=ylim, lty= 2)
plot(apply(hr2,c(1,2),mean)[1,], type="p",  xlim=c(10,90), ylim=c(0,0.2), xaxs='i', yaxs='i', xlab= "Year", ylab = "Harvest rates", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
points(apply(hr2,c(1,2),mean)[1,], col="black", pch=19)
points(apply(hr2,c(1,2),mean)[2,], col="red", pch=19)
points(apply(hr2,c(1,2),mean)[3,], col="black", pch=21)
points(apply(hr2,c(1,2),mean)[4,], col="red", pch=21)
plot(x=yc2noMP$hr, y=yc2noMP$landings, type="l", xlim=xlimYPR, ylim=ylim,xaxs='i', yaxs='i', xlab = "Harvest rate", ylab = "Yield per recruit", panel.first=grid(col = "ivory2"))
text(xlimYPR[2]*0.8, yc2noMP$landings[length(yc2noMP$hr)]+5, "Unconstrained")
abline(v=Fmsy2noMP)
points(mean(hr2[,pyrnoMP,]),yc2noMP$landings[yc2noMP$hr>mean(hr2[,pyrnoMP,])][1], col="red", pch=19)
points(mean(hr2[,pyrnoMP-2,]),landings.wt.dsvm.tot2[,pyrnoMP-2,,], col="blue", pch=19)
points(mean(hr2[,pyrnoMP-1,]),landings.wt.dsvm.tot2[,pyrnoMP-1,,], col="blue", pch=19)
points(mean(hr2[,pyrnoMP,]),landings.wt.dsvm.tot2[,pyrnoMP,,], col="blue", pch=19)
points(mean(hr2[,pyrnoMP+1,]),landings.wt.dsvm.tot2[,pyrnoMP+1,,], col="blue", pch=19)
points(mean(hr2[,pyrnoMP+2,]),landings.wt.dsvm.tot2[,pyrnoMP+2,,], col="blue", pch=19)
lines(x=yc2MP$hr, y=yc2MP$landings, ylim=ylim, col="grey")
text(yc2MP$hr[length(yc2MP$hr)]-0.02, yc2MP$landings[length(yc2MP$hr)]+80, "Constrained")
abline(v=Fmsy2MP, col="grey")
points(mean(hr2[,pyrMP,]),yc2MP$landings[yc2MP$hr>mean(hr2[,pyrMP,])][1], col="red", pch=21, bg="white")
points(mean(hr2[,pyrMP-2,]),landings.wt.dsvm.tot2[,pyrMP-2,,], col="blue", pch=21, bg="white")
points(mean(hr2[,pyrMP-1,]),landings.wt.dsvm.tot2[,pyrMP-1,,], col="blue", pch=21, bg="white")
points(mean(hr2[,pyrMP,]),landings.wt.dsvm.tot2[,pyrMP,,], col="blue", pch=21, bg="white")
points(mean(hr2[,pyrMP+1,]),landings.wt.dsvm.tot2[,pyrMP+1,,], col="blue", pch=21, bg="white")
points(mean(hr2[,pyrMP+2,]),landings.wt.dsvm.tot2[,pyrMP+2,,], col="blue", pch=21, bg="white")
plot(rowMeans(hr2[,pyrnoMP,]), type="b", ylim=c(0,.2), xlab = "Age", ylab = "Selectivity", panel.first=grid(col = "ivory2"), xaxt="n")
text(1.5,rowMeans(hr2[,pyrnoMP,])[1]+0.01, "Unconstrained")
lines(rowMeans(hr2[,pyrMP,]), type="b", ylim=c(0,.2), col="grey")
text(1.5,rowMeans(hr2[,pyrMP,])[1]-0.01, "Constrained")
axis(1, at = seq(1, 4, by = 1))
plot(apply(catches.wt.dsvm2,c(2,4),sum)[,1], col="blue", type="l",  ylim=ylim,xaxs='i', yaxs='i', xlim=c(10,90),xlab = "Year", ylab = "Catches by area (weight)",xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(apply(catches.wt.dsvm2,c(2,4),sum)[,1], col="blue", type="l")
lines(apply(catches.wt.dsvm2,c(2,4),sum)[,2], col="red")
lines(apply(landings.wt.dsvm2,c(2,4),sum)[,1], col="blue", lty=2)
lines(apply(landings.wt.dsvm2,c(2,4),sum)[,2], col="red", lty=2)
#lines(apply(catches.wt.dsvm2,c(2,4),sum)[,3], col="black")
add_legend("bottomright", legend=paste0("SIGMA ", SIGMA, "; SIMNUMBER ",SIMNUMBER, "; DISCARDSTEPS ",SPP1DSCSTEPS, "; MIGRATION ",migconstant, "; REC1 ",paste(recs1, collapse = " "), "; REC2 ",paste(recs2, collapse = " "), "; FUELPRICE ",control@fuelPrice), col="black", horiz=TRUE, bty='n', cex=1)
#round(pop2,0)
#
dev.off()
# Effort pattern and economics
#effort_plot_dsvm(SIMNUMBER, dsvm_res_allyrs, stab.model, economics_res_allyrs)
#effort
effort      <- subset(dsvm_res_allyrs,(spp %in% "sp1"))
effort      <- subset(effort,(cat %in% 1))
effort$year <- factor(effort$year, levels= 1:90)
effort      <- aggregate(cbind(landings.wt, discards.wt, catch.wt, effort,trip)~ spp+cat+option+year, FUN=sum, data=effort)
trip      <- with(effort,data.frame(year, trip, option))
trip      <- dcast(trip ,option~year, value.var="trip")
trip[is.na(trip)]<- 0
rownames(trip)  <- trip$option
trip            <- trip[,-1]
trip_percentage <- matrix(apply(trip, 2, function(x){x*100/sum(x,na.rm=T)}), nrow=nrow(trip))
rownames(trip_percentage) <- rownames(trip)
colnames(trip_percentage) <- colnames(trip)
days      <- with(effort,data.frame(year, effort, option))
days<- days[!days$option=="Stay in port",]
days      <- dcast(days ,option~year, value.var="effort")
days[is.na(days)]<- 0
rownames(days)  <- days$option
days            <- days[,-1]
#economics
netrev      <-  melt(economics_res_allyrs, id.vars = "year", measure.vars = c("NetRev"))
grossrev    <-  melt(economics_res_allyrs, id.vars = "year", measure.vars = c("Grossrev"))
annualfine  <-  melt(economics_res_allyrs, id.vars = "year", measure.vars = c("Annualfine"))
fuelcosts   <-  melt(economics_res_allyrs, id.vars = "year", measure.vars = c("Fuelcosts"))
png(filename=paste("EFFORT_", paste0("SIGMA ", SIGMA, "; SIMNUMBER ",SIMNUMBER, "; DISCARDSTEPS ",SPP1DSCSTEPS, "; MIGRATION ",migconstant, "; REC1 ",paste(recs1, collapse = " "), "; REC2 ",paste(recs2, collapse = " "), "; FUELPRICE ",control@fuelPrice,".png"), sep=""),width=20, height=8, units="cm", res=500, pointsize=6.5)
#to check
par(mfrow=c(2,5),oma = c(3,0,0,0) + 0.1, mar = c(4,4,1,1) + 0.1)
#layout(matrix(c(1,1,2,2, 3,4,5, 6), 2, 4, byrow = TRUE))
mypalette <- c("#808080","#CCCCCC","#D55E00")
names(mypalette) <- c("a", "b", "Stay in port")
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,81), xlab = "Year", ylab = "Effort pattern (%)", xaxt = "n",space = 0)
axis(1, at = c(0.5, 20.5, 30.5, 40.5, 60.5, 80.5),labels = c(10, 30,"MP",50,70,90))
legend("topright", inset=.05, legend=c("a", "b", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
boxplot(value ~ year, netrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean net revenue",
ylim=c(0,4000), xlim=c(1, 81), xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, netrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean net revenue",
ylim=c(0,4000), xlim=c(1, 81), xaxt = "n", add=TRUE)
boxplot(value ~ year, grossrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean gross revenue",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, grossrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean gross revenue",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n", add=TRUE)
boxplot(value ~ year, fuelcosts, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean fuel costs",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, fuelcosts, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean fuel costs",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n", add=TRUE)
boxplot(value ~ year, annualfine, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean annual fine",
ylim=c(0,4000), xlim=c(1,81),  xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, annualfine, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean annual fine",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n", add=TRUE)
barplot(as.matrix(days), col=c("#808080","#CCCCCC"),border=NA, xlim = c(1,81), xlab = "Year", ylab = "Total days at sea", xaxt = "n",space = 0)
axis(1, at = c(0.5, 20.5, 30.5, 40.5, 60.5, 80.5),labels = c(10, 30,"MP",50,70,90))
abline(v=MPstart-9.5, lty=2)
plot(aggregate(value ~ year, FUN=sum, data=netrev)$year,aggregate(value ~ year, FUN=sum, data=netrev)$value, type="l", ylim=c(0,2091351), xlim=c(10,90), xlab = "Year", ylab = "Total net revenue", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=netrev)$year,aggregate(value ~ year, FUN=sum, data=netrev)$value, type="l")
plot(aggregate(value ~ year, FUN=sum, data=grossrev)$year, aggregate(value ~ year, FUN=sum, data=grossrev)$value, type="l", ylim=c(0,2091351), xlim=c(10,90), xlab = "Year", ylab = "Total gross revenue", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=grossrev)$year, aggregate(value ~ year, FUN=sum, data=grossrev)$value, type="l")
plot(aggregate(value ~ year, FUN=sum, data=fuelcosts)$year, aggregate(value ~ year, FUN=sum, data=fuelcosts)$value, type="l", ylim=c(0,2091351), xlim=c(10,90), xlab = "Year", ylab = "Total fuel costs", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=fuelcosts)$year, aggregate(value ~ year, FUN=sum, data=fuelcosts)$value, type="l")
plot(aggregate(value ~ year, FUN=sum, data=annualfine)$year, aggregate(value ~ year, FUN=sum, data=annualfine)$value, type="l", ylim=c(0,209130), xlim=c(10,90),xlab = "Year", ylab = "Total annual fine", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=annualfine)$year, aggregate(value ~ year, FUN=sum, data=annualfine)$value, type="l")
add_legend("bottomright", legend=paste0("SIGMA ", SIGMA, "; SIMNUMBER ",SIMNUMBER, "; DISCARDSTEPS ",SPP1DSCSTEPS, "; MIGRATION ",migconstant, "; REC1 ",paste(recs1, collapse = " "), "; REC2 ",paste(recs2, collapse = " "),"; FUELPRICE ",control@fuelPrice), col="black", horiz=TRUE, bty='n', cex=1)
dev.off()
#  }
#}
hr1[,pyrnoMP,]
mean(hr1[,pyrnoMP,])
yc1noMP <- yield_curve(hr=hr1[,pyrnoMP,], landings.ratio1[,pyrnoMP,], wts, natmortality, R=recs1, verbose=F)
yc2noMP <- yield_curve(hr=hr2[,pyrnoMP,], landings.ratio2[,pyrnoMP,], wts, natmortality, R=recs2, verbose=F)
Fmsy1noMP <- yc1noMP[yc1noMP$catch==max(yc1noMP$catch),]$hr
Fmsy2noMP <- yc2noMP[yc2noMP$landings==max(yc2noMP$landings),]$hr
yc1MP <- yield_curve(hr=hr1[,pyrMP,], landings.ratio1[,pyrMP,], wts, natmortality, R=recs1, verbose=F)
yc2MP <- yield_curve(hr=hr2[,pyrMP,], landings.ratio2[,pyrMP,], wts, natmortality, R=recs2, verbose=F)
Fmsy1MP <- yc1MP[yc1MP$catch==max(yc1MP$catch),]$hr
Fmsy2MP <- yc2MP[yc2MP$landings==max(yc2MP$landings),]$hr
ylim <- c(0,1000)
xlimYPR <- c(0,0.2)
setwd("~/Dropbox/BoB/MSE/Git/Nekane/complex model/figures")
png(filename=paste("CATCH_", paste0("SIGMA ", SIGMA, "; SIMNUMBER ",SIMNUMBER, "; DISCARDSTEPS ",SPP1DSCSTEPS, "; MIGRATION ",migconstant, "; REC1 ",paste(recs1, collapse = " "), "; REC2 ",paste(recs2, collapse = " "), "; FUELPRICE ",control@fuelPrice,".png"), sep=""),width=20, height=8, units="cm", res=500, pointsize=6.5)
#to check
par(mfrow=c(2,5),oma = c(3,0,0,0) + 0.1, mar = c(4,4,1,1) + 0.1)
#,oma = c(4,3,1,1) + 0.1, mar = c(4,4,1,1) + 0.1)
plot(catches.wt.dsvm.tot1, type="l",  xlim=c(10,90), ylim=ylim, xaxs='i', yaxs='i', xlab= "Year", ylab = "Total catches (weight)", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines((quota1* SIMNUMBER), col="red" )
lines(catches.wt.dsvm.tot1,  type="l", ylim=ylim)
lines(landings.wt.dsvm.tot1, type="l", ylim=ylim, lty= 2)
legend("bottomright", inset=.05, legend=c("Catches","TAC"), pch=c(1,1), col=c("black","red"), bty='n', cex=0.8)
plot(apply(hr1,c(1,2),mean)[1,], type="p",  xlim=c(10,90), ylim=c(0,0.2), xaxs='i', yaxs='i', xlab= "Year", ylab = "Harvest rates", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
points(apply(hr1,c(1,2),mean)[1,], col="black", pch=19)
points(apply(hr1,c(1,2),mean)[2,], col="red", pch=19)
points(apply(hr1,c(1,2),mean)[3,], col="black", pch=21)
points(apply(hr1,c(1,2),mean)[4,], col="red", pch=21)
legend("topright", inset=.05, legend=c("Age 1","Age 2","Age 3","Age 4"), pch=c(19,19,21,21), col=c("black","red", "black","red"), bty='n', cex=0.8)
plot(x=yc1noMP$hr, y=yc1noMP$landings, type="l", xlim=xlimYPR, ylim=ylim,xaxs='i', yaxs='i',  xlab="Harvest rate", ylab = "Yield per recruit", panel.first=grid(col = "ivory2"))
text(xlimYPR[2]*0.8, yc1noMP$landings[length(yc1noMP$hr)]+5, "Unconstrained")
abline(v=Fmsy1noMP)
#text(xlimYPR[2]*0.8, ylim[2]*0.9, paste0("SIMNUMBER ",SIMNUMBER))
points(mean(hr1[,pyrnoMP,]),yc1noMP$landings[yc1noMP$hr>mean(hr1[,pyrnoMP,])][1], col="red", pch=19)
points(mean(hr1[,pyrnoMP-2,]),landings.wt.dsvm.tot1[,pyrnoMP-2,,], col="blue", pch=19)
points(mean(hr1[,pyrnoMP-1,]),landings.wt.dsvm.tot1[,pyrnoMP-1,,], col="blue", pch=19)
points(mean(hr1[,pyrnoMP,]),landings.wt.dsvm.tot1[,pyrnoMP,,], col="blue", pch=19)
points(mean(hr1[,pyrnoMP+1,]),landings.wt.dsvm.tot1[,pyrnoMP+1,,], col="blue", pch=19)
points(mean(hr1[,pyrnoMP+2,]),landings.wt.dsvm.tot1[,pyrnoMP+2,,], col="blue", pch=19)
lines(x=yc1MP$hr, y=yc1MP$landings, ylim=ylim, col="grey")
text(yc1MP$hr[length(yc1MP$hr)]-0.02, yc1MP$landings[length(yc1MP$hr)]+80, "Constrained")
abline(v=Fmsy1MP, col="grey")
points(mean(hr1[,pyrMP,]),yc1MP$landings[yc1MP$hr>mean(hr1[,pyrMP,])][1], col="red", pch=21, bg="white")
points(mean(hr1[,pyrMP-2,]),landings.wt.dsvm.tot1[,pyrMP-2,,], col="blue", pch=21, bg="white")
points(mean(hr1[,pyrMP-1,]),landings.wt.dsvm.tot1[,pyrMP-1,,], col="blue", pch=21, bg="white")
points(mean(hr1[,pyrMP,]),landings.wt.dsvm.tot1[,pyrMP,,], col="blue", pch=21, bg="white")
points(mean(hr1[,pyrMP+1,]),landings.wt.dsvm.tot1[,pyrMP+1,,], col="blue", pch=21, bg="white")
points(mean(hr1[,pyrMP+2,]),landings.wt.dsvm.tot1[,pyrMP+2,,], col="blue", pch=21, bg="white")
plot(rowMeans(hr1[,pyrnoMP,]), type="b", ylim=c(0,.2),  xlab="Age", ylab = "Selectivity", panel.first=grid(col = "ivory2"), xaxt="n")
text(1.5,rowMeans(hr1[,pyrnoMP,])[1]+0.01, "Unconstrained")
lines(rowMeans(hr1[,pyrMP,]), type="b", ylim=c(0,.2), col="grey")
text(1.5,rowMeans(hr1[,pyrMP,])[1]-0.01, "Constrained")
axis(1, at = seq(1, 4, by = 1))
plot(apply(catches.wt.dsvm1,c(2,4),sum)[,1], col="blue", type="l",  ylim=ylim,xaxs='i', yaxs='i', xlim=c(10,90),xlab = "Year", ylab = "Catches by area (weight)",xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(apply(catches.wt.dsvm1,c(2,4),sum)[,1], col="blue", type="l")
lines(apply(catches.wt.dsvm1,c(2,4),sum)[,2], col="red")
lines(apply(landings.wt.dsvm1,c(2,4),sum)[,1], col="blue", lty=2)
lines(apply(landings.wt.dsvm1,c(2,4),sum)[,2], col="red", lty=2)
#lines(apply(catches.wt.dsvm1,c(2,4),sum)[,3], col="black")
legend("topright", inset=.05, c("a","b"),  pch=c(1,1), col=c("blue","red"), bty='n', cex=0.8)
abline(v=MPstart, lty=2)
#round(pop1,0)
plot(catches.wt.dsvm.tot2, type="l",  xlim=c(10,90), ylim=ylim, xaxs='i', yaxs='i', xlab= "Year", ylab = "Total catches (weight)", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(catches.wt.dsvm.tot2,  type="l", ylim=ylim)
lines(landings.wt.dsvm.tot2, type="l", ylim=ylim, lty= 2)
plot(apply(hr2,c(1,2),mean)[1,], type="p",  xlim=c(10,90), ylim=c(0,0.2), xaxs='i', yaxs='i', xlab= "Year", ylab = "Harvest rates", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
points(apply(hr2,c(1,2),mean)[1,], col="black", pch=19)
points(apply(hr2,c(1,2),mean)[2,], col="red", pch=19)
points(apply(hr2,c(1,2),mean)[3,], col="black", pch=21)
points(apply(hr2,c(1,2),mean)[4,], col="red", pch=21)
plot(x=yc2noMP$hr, y=yc2noMP$landings, type="l", xlim=xlimYPR, ylim=ylim,xaxs='i', yaxs='i', xlab = "Harvest rate", ylab = "Yield per recruit", panel.first=grid(col = "ivory2"))
text(xlimYPR[2]*0.8, yc2noMP$landings[length(yc2noMP$hr)]+5, "Unconstrained")
abline(v=Fmsy2noMP)
points(mean(hr2[,pyrnoMP,]),yc2noMP$landings[yc2noMP$hr>mean(hr2[,pyrnoMP,])][1], col="red", pch=19)
points(mean(hr2[,pyrnoMP-2,]),landings.wt.dsvm.tot2[,pyrnoMP-2,,], col="blue", pch=19)
points(mean(hr2[,pyrnoMP-1,]),landings.wt.dsvm.tot2[,pyrnoMP-1,,], col="blue", pch=19)
points(mean(hr2[,pyrnoMP,]),landings.wt.dsvm.tot2[,pyrnoMP,,], col="blue", pch=19)
points(mean(hr2[,pyrnoMP+1,]),landings.wt.dsvm.tot2[,pyrnoMP+1,,], col="blue", pch=19)
points(mean(hr2[,pyrnoMP+2,]),landings.wt.dsvm.tot2[,pyrnoMP+2,,], col="blue", pch=19)
lines(x=yc2MP$hr, y=yc2MP$landings, ylim=ylim, col="grey")
text(yc2MP$hr[length(yc2MP$hr)]-0.02, yc2MP$landings[length(yc2MP$hr)]+80, "Constrained")
abline(v=Fmsy2MP, col="grey")
points(mean(hr2[,pyrMP,]),yc2MP$landings[yc2MP$hr>mean(hr2[,pyrMP,])][1], col="red", pch=21, bg="white")
points(mean(hr2[,pyrMP-2,]),landings.wt.dsvm.tot2[,pyrMP-2,,], col="blue", pch=21, bg="white")
points(mean(hr2[,pyrMP-1,]),landings.wt.dsvm.tot2[,pyrMP-1,,], col="blue", pch=21, bg="white")
points(mean(hr2[,pyrMP,]),landings.wt.dsvm.tot2[,pyrMP,,], col="blue", pch=21, bg="white")
points(mean(hr2[,pyrMP+1,]),landings.wt.dsvm.tot2[,pyrMP+1,,], col="blue", pch=21, bg="white")
points(mean(hr2[,pyrMP+2,]),landings.wt.dsvm.tot2[,pyrMP+2,,], col="blue", pch=21, bg="white")
plot(rowMeans(hr2[,pyrnoMP,]), type="b", ylim=c(0,.2), xlab = "Age", ylab = "Selectivity", panel.first=grid(col = "ivory2"), xaxt="n")
text(1.5,rowMeans(hr2[,pyrnoMP,])[1]+0.01, "Unconstrained")
lines(rowMeans(hr2[,pyrMP,]), type="b", ylim=c(0,.2), col="grey")
text(1.5,rowMeans(hr2[,pyrMP,])[1]-0.01, "Constrained")
axis(1, at = seq(1, 4, by = 1))
plot(apply(catches.wt.dsvm2,c(2,4),sum)[,1], col="blue", type="l",  ylim=ylim,xaxs='i', yaxs='i', xlim=c(10,90),xlab = "Year", ylab = "Catches by area (weight)",xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
polygon(x=c(pyrnoMP-2,pyrnoMP+2,pyrnoMP+2,pyrnoMP-2), border=NA, y=c(rep(ylim,each=2)), col="gray")
polygon(x=c(pyrMP-2,pyrMP+2,pyrMP+2,pyrMP-2)        , border=NA, y=c(rep(ylim,each=2)), col="ivory2")
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(30, 50, 70), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(apply(catches.wt.dsvm2,c(2,4),sum)[,1], col="blue", type="l")
lines(apply(catches.wt.dsvm2,c(2,4),sum)[,2], col="red")
lines(apply(landings.wt.dsvm2,c(2,4),sum)[,1], col="blue", lty=2)
lines(apply(landings.wt.dsvm2,c(2,4),sum)[,2], col="red", lty=2)
#lines(apply(catches.wt.dsvm2,c(2,4),sum)[,3], col="black")
add_legend("bottomright", legend=paste0("SIGMA ", SIGMA, "; SIMNUMBER ",SIMNUMBER, "; DISCARDSTEPS ",SPP1DSCSTEPS, "; MIGRATION ",migconstant, "; REC1 ",paste(recs1, collapse = " "), "; REC2 ",paste(recs2, collapse = " "), "; FUELPRICE ",control@fuelPrice), col="black", horiz=TRUE, bty='n', cex=1)
#round(pop2,0)
#
dev.off()
# Effort pattern and economics
#effort_plot_dsvm(SIMNUMBER, dsvm_res_allyrs, stab.model, economics_res_allyrs)
#effort
effort      <- subset(dsvm_res_allyrs,(spp %in% "sp1"))
effort      <- subset(effort,(cat %in% 1))
effort$year <- factor(effort$year, levels= 1:90)
effort      <- aggregate(cbind(landings.wt, discards.wt, catch.wt, effort,trip)~ spp+cat+option+year, FUN=sum, data=effort)
trip      <- with(effort,data.frame(year, trip, option))
trip      <- dcast(trip ,option~year, value.var="trip")
trip[is.na(trip)]<- 0
rownames(trip)  <- trip$option
trip            <- trip[,-1]
trip_percentage <- matrix(apply(trip, 2, function(x){x*100/sum(x,na.rm=T)}), nrow=nrow(trip))
rownames(trip_percentage) <- rownames(trip)
colnames(trip_percentage) <- colnames(trip)
days      <- with(effort,data.frame(year, effort, option))
days<- days[!days$option=="Stay in port",]
days      <- dcast(days ,option~year, value.var="effort")
days[is.na(days)]<- 0
rownames(days)  <- days$option
days            <- days[,-1]
#economics
netrev      <-  melt(economics_res_allyrs, id.vars = "year", measure.vars = c("NetRev"))
grossrev    <-  melt(economics_res_allyrs, id.vars = "year", measure.vars = c("Grossrev"))
annualfine  <-  melt(economics_res_allyrs, id.vars = "year", measure.vars = c("Annualfine"))
fuelcosts   <-  melt(economics_res_allyrs, id.vars = "year", measure.vars = c("Fuelcosts"))
png(filename=paste("EFFORT_", paste0("SIGMA ", SIGMA, "; SIMNUMBER ",SIMNUMBER, "; DISCARDSTEPS ",SPP1DSCSTEPS, "; MIGRATION ",migconstant, "; REC1 ",paste(recs1, collapse = " "), "; REC2 ",paste(recs2, collapse = " "), "; FUELPRICE ",control@fuelPrice,".png"), sep=""),width=20, height=8, units="cm", res=500, pointsize=6.5)
#to check
par(mfrow=c(2,5),oma = c(3,0,0,0) + 0.1, mar = c(4,4,1,1) + 0.1)
#layout(matrix(c(1,1,2,2, 3,4,5, 6), 2, 4, byrow = TRUE))
mypalette <- c("#808080","#CCCCCC","#D55E00")
names(mypalette) <- c("a", "b", "Stay in port")
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,81), xlab = "Year", ylab = "Effort pattern (%)", xaxt = "n",space = 0)
axis(1, at = c(0.5, 20.5, 30.5, 40.5, 60.5, 80.5),labels = c(10, 30,"MP",50,70,90))
legend("topright", inset=.05, legend=c("a", "b", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
boxplot(value ~ year, netrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean net revenue",
ylim=c(0,4000), xlim=c(1, 81), xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, netrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean net revenue",
ylim=c(0,4000), xlim=c(1, 81), xaxt = "n", add=TRUE)
boxplot(value ~ year, grossrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean gross revenue",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, grossrev, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean gross revenue",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n", add=TRUE)
boxplot(value ~ year, fuelcosts, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean fuel costs",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, fuelcosts, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean fuel costs",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n", add=TRUE)
boxplot(value ~ year, annualfine, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean annual fine",
ylim=c(0,4000), xlim=c(1,81),  xaxt = "n")
axis(1, at = c(1, 21, 31, 41, 61, 81),labels = c(10, 30,"MP", 50,70,90))
grid(NA, NULL, col = "ivory2")
abline(v=c(1, 21, 41, 61, 81), lty="dotted", col = "ivory2")
abline(v=MPstart-9, lty=2)
boxplot(value ~ year, annualfine, cex = 0.6, col="grey",boxwex=1, xlab = "Year", ylab = "Mean annual fine",
ylim=c(0,4000), xlim=c(1,81), xaxt = "n", add=TRUE)
barplot(as.matrix(days), col=c("#808080","#CCCCCC"),border=NA, xlim = c(1,81), xlab = "Year", ylab = "Total days at sea", xaxt = "n",space = 0)
axis(1, at = c(0.5, 20.5, 30.5, 40.5, 60.5, 80.5),labels = c(10, 30,"MP",50,70,90))
abline(v=MPstart-9.5, lty=2)
plot(aggregate(value ~ year, FUN=sum, data=netrev)$year,aggregate(value ~ year, FUN=sum, data=netrev)$value, type="l", ylim=c(0,2091351), xlim=c(10,90), xlab = "Year", ylab = "Total net revenue", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=netrev)$year,aggregate(value ~ year, FUN=sum, data=netrev)$value, type="l")
plot(aggregate(value ~ year, FUN=sum, data=grossrev)$year, aggregate(value ~ year, FUN=sum, data=grossrev)$value, type="l", ylim=c(0,2091351), xlim=c(10,90), xlab = "Year", ylab = "Total gross revenue", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=grossrev)$year, aggregate(value ~ year, FUN=sum, data=grossrev)$value, type="l")
plot(aggregate(value ~ year, FUN=sum, data=fuelcosts)$year, aggregate(value ~ year, FUN=sum, data=fuelcosts)$value, type="l", ylim=c(0,2091351), xlim=c(10,90), xlab = "Year", ylab = "Total fuel costs", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=fuelcosts)$year, aggregate(value ~ year, FUN=sum, data=fuelcosts)$value, type="l")
plot(aggregate(value ~ year, FUN=sum, data=annualfine)$year, aggregate(value ~ year, FUN=sum, data=annualfine)$value, type="l", ylim=c(0,209130), xlim=c(10,90),xlab = "Year", ylab = "Total annual fine", xaxt = "n", panel.first=grid(NA, NULL,col = "ivory2"))
axis(1, at = c(10, 30, 40, 50, 70, 90),labels = c(10, 30, "MP", 50,70,90))
abline(v=c(10, 30, 50, 70, 90), lty="dotted", col = "ivory2")
abline(v=MPstart, lty=2)
lines(aggregate(value ~ year, FUN=sum, data=annualfine)$year, aggregate(value ~ year, FUN=sum, data=annualfine)$value, type="l")
add_legend("bottomright", legend=paste0("SIGMA ", SIGMA, "; SIMNUMBER ",SIMNUMBER, "; DISCARDSTEPS ",SPP1DSCSTEPS, "; MIGRATION ",migconstant, "; REC1 ",paste(recs1, collapse = " "), "; REC2 ",paste(recs2, collapse = " "),"; FUELPRICE ",control@fuelPrice), col="black", horiz=TRUE, bty='n', cex=1)
dev.off()
#  }
#}
