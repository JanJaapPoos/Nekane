recs1          <- c(500,0)
mig1     <- array(0, dim=c(length(ages),1,length(season),length(areas), length(areas)), dimnames=list(cat=ages,year="all",season=as.character(season), from =areas, to=areas))
mig1[,,,"a","a"] <- -migconstant
mig1[,,,"b","b"] <- -migconstant
mig1[,,,"a","b"] <- migconstant
mig1[,,,"b","a"] <- migconstant
aperm( mig1,c(1,3,2,4,5))
recs2          <- c(0,500)
mig2     <- array(0, dim=c(length(ages),1,length(season),length(areas), length(areas)), dimnames=list(cat=ages,year="all",season=as.character(season), from =areas, to=areas))
mig2[,,,"a","a"] <- -migconstant
mig2[,,,"b","b"] <- -migconstant
mig2[,,,"a","b"] <- migconstant
mig2[,,,"b","a"] <- migconstant
aperm( mig2,c(1,3,2,4,5))
effort <- array(c(1), dim=c(length(areas), length(season)), dimnames=list(option =areas,season=as.character(season)))
pop1  <- pop2         <-array(0, dim=c(length(ages),endy+1,length(season),length(areas)), dimnames=list(cat=ages,   year=as.character(1:(endy+1)), season=as.character(season), option =areas))
catches.n.dsvm1       <- catches.n.dsvm2       <- array(0, dim=c(length(ages),endy,length(season),length(areas)), dimnames=list(cat=ages,   year=as.character(1:endy), season=as.character(season), option =areas))
landings.n.dsvm1      <- landings.n.dsvm2      <- array(0, dim=c(length(ages),endy,length(season),length(areas)), dimnames=list(cat=ages,   year=as.character(1:endy), season=as.character(season), option =areas))
catches.wt.dsvm1      <- catches.wt.dsvm2      <- array(0, dim=c(length(ages),endy,length(season),length(areas)), dimnames=list(cat=ages,   year=as.character(1:endy), season=as.character(season), option =areas))
landings.wt.dsvm1     <- landings.wt.dsvm2     <- array(0, dim=c(length(ages),endy,length(season),length(areas)), dimnames=list(cat=ages,   year=as.character(1:endy), season=as.character(season), option =areas))
catches.wt.dsvm.tot1  <- catches.wt.dsvm.tot2  <- array(0, dim=c(1           ,endy,              1,            1), dimnames=list(cat="all", year=as.character(1:endy), season="all",                option ="all"))
landings.wt.dsvm.tot1 <- landings.wt.dsvm.tot2 <- array(0, dim=c(1           ,endy,              1,            1), dimnames=list(cat="all", year=as.character(1:endy), season="all",                option ="all"))
quota1                <- quota2                <- array(1000, dim=c(1           ,endy,              1,            1), dimnames=list(cat="all", year=as.character(1:endy), season="all",                option ="all"))
pos_catches1 <- pos_catches2 <- pop1
hr1wanted <- hr2wanted <- array(NA, dim=c(1           ,endy,              1,            1), dimnames=list(cat="all", year=as.character(1:endy), season="all",                option ="all"))
#run population for 15 year
pop1 <- population_dynamics(pop=pop1, startyear=2, endyear=stab.model, season=season, natmortality=natmortality, catches=catches.n.dsvm1[,1,,, drop=F], recruitment=recs1, migration=mig1)
pop2 <- population_dynamics(pop=pop2, startyear=2, endyear=stab.model, season=season, natmortality=natmortality, catches=catches.n.dsvm1[,1,,, drop=F], recruitment=recs2, migration=mig2)
#set up dsvm
sp1<- sp2 <- sp3 <- sp4 <- sp5 <-    new("DynStateInput")
catchMean(sp1)  <- catchMean(sp2) <- array(NA, dim=c(length(ages), length(season),length(areas)),  dimnames=list("cat"=ages,"season"= season,"option"=areas))
catchMean(sp3)  <- catchMean(sp4) <- catchMean(sp5) <- array(0.01,dim=c(length(ages),length(season),length(areas)),dimnames=list(cat=ages,season=as.character(season),option =areas))
catchSigma(sp3) <- catchSigma(sp4)<- catchSigma(sp5)<- array(0.0000001,dim=c(length(ages),length(season),length(areas)),dimnames=list(cat=ages,season=as.character(season),option =areas))
#SIZE DEPENDENT PRICING, following Zimmermann et al. (2011)
sp1Price <- array(c(sp1price + slope1price*(((wts-mean(wts))/mean(wts)))), dim=c(length(ages),length(season)), dimnames=list(cat=ages,season=as.character(season)))
sp2Price <- array(c(sp2price + slope2price*(((wts-mean(wts))/mean(wts)))), dim=c(length(ages),length(season)), dimnames=list(cat=ages,season=as.character(season)))
sp3Price <- sp4Price <- sp5Price <- array(c(0), dim=c(length(ages),length(season)), dimnames=list(cat=ages,season=as.character(season)))
#---effort and prices used (note that now c is removed (but that if other runs, then make sure to fix/remove code that removes "c" option)
control     <- DynState.control(spp1LndQuota= quota1[,1,,],  spp2LndQuota=quota2[,1,,], spp1LndQuotaFine= 3e6, spp2LndQuotaFine= 3e6, fuelUse = 1, fuelPrice = FuelPrice, landingCosts= 0,gearMaintenance= 0,
addNoFishing= TRUE, increments= 25, spp1DiscardSteps= SPP1DSCSTEPS, spp2DiscardSteps= SPP2DSCSTEPS, sigma= SIGMA, simNumber= SIMNUMBER * 0.5 , numThreads= 68, verbose=1)
quota1
catchMean(sp1)
catchMean(sp1)[1,,] <- pop1[1,as.character(yy-1),,] *q*wts[1,1,,1]
yy<-10
catchMean(sp1)[1,,] <- pop1[1,as.character(yy-1),,] *q*wts[1,1,,1]
catchMean(sp1)
cfracs1 <- sweep( pop1[-1,as.character(yy-1),,] ,c(1,3),  pop1[1:(max(ages)-1),as.character(yy-2),max(season),] , FUN="/")
cfracs2 <- sweep( pop1[-1,as.character(yy-2),,] ,c(1,3),  pop1[1:(max(ages)-1),as.character(yy-3),max(season),] , FUN="/")
cfracs <- (cfracs1 + cfracs2)/2
catchMean(sp1)[-1,,] <- sweep(cfracs,c(1,3),pop1[1:(max(ages)-1),as.character(yy-1),max(season),] ,FUN="*") *q
catchMean(sp1)[-1,,] <- sweep(catchMean(sp1)[-1,,],c(1,2), wts[-1,1,,1],FUN="*")
catchMean(sp2)[1,,] <- pop2[1,as.character(yy-1),,] *q*wts[1,1,,1]
cfracs1 <- sweep( pop2[-1,as.character(yy-1),,] ,c(1,3),  pop2[1:(max(ages)-1),as.character(yy-2),max(season),] , FUN="/")
cfracs2 <- sweep( pop2[-1,as.character(yy-2),,] ,c(1,3),  pop2[1:(max(ages)-1),as.character(yy-3),max(season),] , FUN="/")
cfracs <- (cfracs1 + cfracs2)/2
catchMean(sp2)[-1,,] <- sweep(cfracs,c(1,3),pop2[1:(max(ages)-1),as.character(yy-1),max(season),] ,FUN="*") *q
catchMean(sp2)[-1,,] <- sweep(catchMean(sp2)[-1,,],c(1,2), wts[-1,1,,1],FUN="*")
catchMean(sp1)
sum(catchMean(sp1))
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/1quota12seasons.RData")
View(dsvm_res_allyrs)
sum(catchMean(sp1)[,,1])
sum(catchMean(sp1)[,,2])
catchMean(sp1)[,,1]
catchMean(sp1)[,,1]*1919
sum(catchMean(sp1)[,,1]*1919)
sum(catchMean(sp1)[,,2]*2081)
catchMean(sp1)[,,2]*2081
sum(catchMean(sp1)[,,2]*2081)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/1quota12seasons.RData")
quota1
quota1* SIMNUMBER
##############################################################################
library(fields)
require(graphics)
setwd("~/Dropbox/BoB/MSE/Git/Nekane_MSE/doc/Figures")
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/1quota12seasons.RData")
mypalette <- c("#808080","#CCCCCC","#D55E00")
names(mypalette) <- c("North", "South", "Stay in port")
#nf=layout(matrix(c(1,2,1,3,4,5,4,6), 4, 2, byrow = TRUE))
#par(oma = c(3,0,0,0) + 0.1, mar = c(4,5,1,1) + 0.1)
par(par(no.readonly=TRUE))
par(oma=c(3,3,0,0),mar=c(3,3,2,2),mfrow=c(2,2))
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(a)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Effort pattern (%)",side=2, line=1,adj = 0.5,font=2,outer=TRUE)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
a[2]<-a[2]/1000000
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
b[2]<-b[2]/1000000
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
c[2]<-c[2]/1000000
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(b)",side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Economics (thousand euro)",side=2, line=3,adj =45,font=2,outer=TRUE)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/2quotas12seasons.RData")
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(c)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
# maxval_mp<- b$value[16]
# a[2]<-a[2]/maxval_mp*100
# b[2]<-b[2]/maxval_mp*100
# c[2]<-c[2]/maxval_mp*100
# d[2]<-d[2]/maxval_mp*100
# ylim= c(0, 150)
# a[2]<-a[2]/1000000
a[2]<-a[2]/1000000
b[2]<-b[2]/1000000
c[2]<-c[2]/1000000
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(d)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
legend("bottomright", inset=.01, legend=c("Net revenue","Gross revenue", "Fuel cost", "Annual fine"), pch=c(1,1,1,1), lwd=c(2,2,2,2),col=c("black","#808080","blue","red"), bty='n',text.font =2, cex=0.75)
mtext(text="Year",side=1,line=0,font=2,outer=TRUE)
postscript(file="Efforteconomics.eps", onefile=FALSE, horizontal=FALSE,width=8.5,height=6.5)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/1quota12seasons.RData")
mypalette <- c("#808080","#CCCCCC","#D55E00")
names(mypalette) <- c("North", "South", "Stay in port")
#nf=layout(matrix(c(1,2,1,3,4,5,4,6), 4, 2, byrow = TRUE))
#par(oma = c(3,0,0,0) + 0.1, mar = c(4,5,1,1) + 0.1)
par(par(no.readonly=TRUE))
par(oma=c(3,3,0,0),mar=c(3,3,2,2),mfrow=c(2,2))
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(a)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Effort pattern (%)",side=2, line=1,adj = 0.5,font=2,outer=TRUE)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
a[2]<-a[2]/1000000
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
b[2]<-b[2]/1000000
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
c[2]<-c[2]/1000000
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(b)",side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Economics (thousand euro)",side=2, line=3,adj =45,font=2,outer=TRUE)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/2quotas12seasons.RData")
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(c)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
# maxval_mp<- b$value[16]
# a[2]<-a[2]/maxval_mp*100
# b[2]<-b[2]/maxval_mp*100
# c[2]<-c[2]/maxval_mp*100
# d[2]<-d[2]/maxval_mp*100
# ylim= c(0, 150)
# a[2]<-a[2]/1000000
a[2]<-a[2]/1000000
b[2]<-b[2]/1000000
c[2]<-c[2]/1000000
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(d)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
legend("bottomright", inset=.01, legend=c("Net revenue","Gross revenue", "Fuel cost", "Annual fine"), pch=c(1,1,1,1), lwd=c(2,2,2,2),col=c("black","#808080","blue","red"), bty='n',text.font =2, cex=0.75)
mtext(text="Year",side=1,line=0,font=2,outer=TRUE)
dev.off()
postscript(file="Efforteconomics.eps", onefile=FALSE, horizontal=FALSE,width=8.5,height=6.5)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/1quota12seasons.RData")
mypalette <- c("#808080","#CCCCCC","#D55E00")
names(mypalette) <- c("North", "South", "Stay in port")
#nf=layout(matrix(c(1,2,1,3,4,5,4,6), 4, 2, byrow = TRUE))
#par(oma = c(3,0,0,0) + 0.1, mar = c(4,5,1,1) + 0.1)
par(par(no.readonly=TRUE))
par(oma=c(3,3,0,0),mar=c(3,3,2,2),mfrow=c(2,2))
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(a)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Effort pattern (%)",side=2, line=1,adj = 0.5,font=2,outer=TRUE)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
a[2]<-a[2]/1000000
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
b[2]<-b[2]/1000000
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
c[2]<-c[2]/1000000
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(b)",side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Economics (thousand euro)",side=2, line=3,adj =0.5,at=-15,font=2)#side=2, line=3,adj =45,font=2,outer=TRUE)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/2quotas12seasons.RData")
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(c)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
# maxval_mp<- b$value[16]
# a[2]<-a[2]/maxval_mp*100
# b[2]<-b[2]/maxval_mp*100
# c[2]<-c[2]/maxval_mp*100
# d[2]<-d[2]/maxval_mp*100
# ylim= c(0, 150)
# a[2]<-a[2]/1000000
a[2]<-a[2]/1000000
b[2]<-b[2]/1000000
c[2]<-c[2]/1000000
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(d)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
legend("bottomright", inset=.01, legend=c("Net revenue","Gross revenue", "Fuel cost", "Annual fine"), pch=c(1,1,1,1), lwd=c(2,2,2,2),col=c("black","#808080","blue","red"), bty='n',text.font =2, cex=0.75)
mtext(text="Year",side=1,line=0,font=2,outer=TRUE)
dev.off()
postscript(file="Efforteconomics.eps", onefile=FALSE, horizontal=FALSE,width=8.5,height=6.5)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/1quota12seasons.RData")
mypalette <- c("#808080","#CCCCCC","#D55E00")
names(mypalette) <- c("North", "South", "Stay in port")
#nf=layout(matrix(c(1,2,1,3,4,5,4,6), 4, 2, byrow = TRUE))
#par(oma = c(3,0,0,0) + 0.1, mar = c(4,5,1,1) + 0.1)
par(par(no.readonly=TRUE))
par(oma=c(3,3,0,0),mar=c(3,3,2,2),mfrow=c(2,2))
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(a)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Effort pattern (%)",side=2, line=1,adj = 0.5,font=2,outer=TRUE)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
a[2]<-a[2]/1000000
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
b[2]<-b[2]/1000000
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
c[2]<-c[2]/1000000
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(b)",side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Economics (thousand euro)",side=2, line=3,adj =0.5,at=-10,font=2)#side=2, line=3,adj =45,font=2,outer=TRUE)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/2quotas12seasons.RData")
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(c)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
# maxval_mp<- b$value[16]
# a[2]<-a[2]/maxval_mp*100
# b[2]<-b[2]/maxval_mp*100
# c[2]<-c[2]/maxval_mp*100
# d[2]<-d[2]/maxval_mp*100
# ylim= c(0, 150)
# a[2]<-a[2]/1000000
a[2]<-a[2]/1000000
b[2]<-b[2]/1000000
c[2]<-c[2]/1000000
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(d)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
legend("bottomright", inset=.01, legend=c("Net revenue","Gross revenue", "Fuel cost", "Annual fine"), pch=c(1,1,1,1), lwd=c(2,2,2,2),col=c("black","#808080","blue","red"), bty='n',text.font =2, cex=0.75)
mtext(text="Year",side=1,line=0,font=2,outer=TRUE)
dev.off()
postscript(file="Efforteconomics.eps", onefile=FALSE, horizontal=FALSE,width=8.5,height=6.5)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/1quota12seasons.RData")
mypalette <- c("#808080","#CCCCCC","#D55E00")
names(mypalette) <- c("North", "South", "Stay in port")
#nf=layout(matrix(c(1,2,1,3,4,5,4,6), 4, 2, byrow = TRUE))
#par(oma = c(3,0,0,0) + 0.1, mar = c(4,5,1,1) + 0.1)
par(par(no.readonly=TRUE))
par(oma=c(3,3,0,0),mar=c(3,3,2,2),mfrow=c(2,2))
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(a)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Effort pattern (%)",side=2, line=1,adj = 0.5,font=2,outer=TRUE)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
a[2]<-a[2]/1000000
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
b[2]<-b[2]/1000000
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
c[2]<-c[2]/1000000
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(b)",side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Economics (thousand euro)",side=2, line=3,adj =0.5,at=-20,font=2)#side=2, line=3,adj =45,font=2,outer=TRUE)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/2quotas12seasons.RData")
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(c)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
# maxval_mp<- b$value[16]
# a[2]<-a[2]/maxval_mp*100
# b[2]<-b[2]/maxval_mp*100
# c[2]<-c[2]/maxval_mp*100
# d[2]<-d[2]/maxval_mp*100
# ylim= c(0, 150)
# a[2]<-a[2]/1000000
a[2]<-a[2]/1000000
b[2]<-b[2]/1000000
c[2]<-c[2]/1000000
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(d)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
legend("bottomright", inset=.01, legend=c("Net revenue","Gross revenue", "Fuel cost", "Annual fine"), pch=c(1,1,1,1), lwd=c(2,2,2,2),col=c("black","#808080","blue","red"), bty='n',text.font =2, cex=0.75)
mtext(text="Year",side=1,line=0,font=2,outer=TRUE)
dev.off()
postscript(file="Efforteconomics.eps", onefile=FALSE, horizontal=FALSE,width=8.5,height=6.5)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/1quota12seasons.RData")
mypalette <- c("#808080","#CCCCCC","#D55E00")
names(mypalette) <- c("North", "South", "Stay in port")
#nf=layout(matrix(c(1,2,1,3,4,5,4,6), 4, 2, byrow = TRUE))
#par(oma = c(3,0,0,0) + 0.1, mar = c(4,5,1,1) + 0.1)
par(par(no.readonly=TRUE))
par(oma=c(3,3,0,0),mar=c(3,3,2,2),mfrow=c(2,2))
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(a)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Effort pattern (%)",side=2, line=1,adj = 0.5,font=2,outer=TRUE)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
a[2]<-a[2]/1000000
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
b[2]<-b[2]/1000000
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
c[2]<-c[2]/1000000
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(b)",side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
mtext(text="Economics (thousand euro)",side=2, line=3,adj =0.5,at=-100,font=2)#side=2, line=3,adj =45,font=2,outer=TRUE)
load("~/Dropbox/BoB/MSE/Git/Nekane_MSE/complex model/2quotas12seasons.RData")
barplot(trip_percentage, col= mypalette, border=NA, xlim = c(1,NUMRUNS+1), xlab = "", ylab = "", xaxt = "n",space = 0,las=1)
axis(1, at =c(0.5,(MPstart-stab.model)/2+0.5, MPstart-stab.model+0.5, MPstart+((endy-MPstart)/2)-stab.model+0.5, NUMRUNS+0.5),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
axis(2, at =seq(0,100,20), label=seq(0,100,20),las=1)
legend("topright", inset=.05, legend=c("North", "South", "Stay in port"), fill=mypalette, cex=0.6)
abline(v=MPstart-9.5, lty=2)
box()
mtext("(c)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
a<- aggregate(value ~ year, FUN=sum, data=netrev)
b<- aggregate(value ~ year, FUN=sum, data=grossrev)
c<- aggregate(value ~ year, FUN=sum, data=fuelcosts)
d<- aggregate(value ~ year, FUN=sum, data=annualfine)
# maxval_mp<- b$value[16]
# a[2]<-a[2]/maxval_mp*100
# b[2]<-b[2]/maxval_mp*100
# c[2]<-c[2]/maxval_mp*100
# d[2]<-d[2]/maxval_mp*100
# ylim= c(0, 150)
# a[2]<-a[2]/1000000
a[2]<-a[2]/1000000
b[2]<-b[2]/1000000
c[2]<-c[2]/1000000
d[2]<-d[2]/1000000
ylim= c(0, 350)
plot(a, type="l",  xlim=c(stab.model,endy), ylim=ylim, xaxs='i', yaxs='i', xlab="", ylab="", xaxt = "n", panel.first=grid(col = "ivory3"), las=1)
lines(a, type="l")
lines(b, type="l", col="#808080")
lines(c, type="l",col="blue")
lines(d, type="l",col="red")
axis(1,  at = c(stab.model, stab.model+((MPstart-stab.model)/2), MPstart, MPstart+((endy-MPstart)/2), endy),
labels = c(stab.model, stab.model+((MPstart-stab.model)/2),    "MP", MPstart+((endy-MPstart)/2), endy))
abline(v=MPstart, lty=2)
mtext("(d)", side=1, line = -1.3, adj = 0.04, font=2, cex = 1)
legend("bottomright", inset=.01, legend=c("Net revenue","Gross revenue", "Fuel cost", "Annual fine"), pch=c(1,1,1,1), lwd=c(2,2,2,2),col=c("black","#808080","blue","red"), bty='n',text.font =2, cex=0.75)
mtext(text="Year",side=1,line=0,font=2,outer=TRUE)
dev.off()
